<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ Wildberries ‚Üí Ozon</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            padding: 30px;
            margin-bottom: 30px;
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            background-color: #f8f9ff;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }
        
        .upload-area:hover {
            background-color: #eef1ff;
            border-color: #764ba2;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        .file-info {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .preview-table th,
        .preview-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .preview-table th {
            background-color: #667eea;
            color: white;
            position: sticky;
            top: 0;
        }
        
        .preview-table tr:nth-child(even) {
            background-color: #f8f9ff;
        }
        
        .preview-container {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .download-section {
            text-align: center;
            display: none;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #764ba2;
        }
        
        footer {
            text-align: center;
            color: white;
            padding: 20px;
            margin-top: 30px;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .preview-table {
                font-size: 0.8rem;
            }
            
            .preview-table th,
            .preview-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ Wildberries ‚Üí Ozon</h1>
            <p class="subtitle">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Ç–æ–≤–∞—Ä–æ–≤ —Å Wildberries –≤ —Ñ–æ—Ä–º–∞—Ç Ozon</p>
        </header>
        
        <div class="card">
            <h2>–®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å Wildberries</h2>
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìÅ</div>
                <p class="upload-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                <p>(–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xls, .xlsx)</p>
                <input type="file" id="fileInput" accept=".xls,.xlsx" style="display: none;">
            </div>
            <div class="file-info" id="fileInfo">
                <strong>–í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª:</strong> <span id="fileName"></span>
                <br>
                <strong>–†–∞–∑–º–µ—Ä:</strong> <span id="fileSize"></span>
            </div>
            <button class="btn" id="processBtn" disabled>–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª</button>
        </div>
        
        <div class="card">
            <h2>–®–∞–≥ 2: –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö</h2>
            <div class="status" id="previewStatus"></div>
            <div class="preview-container">
                <table class="preview-table" id="previewTable">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–ê—Ä—Ç–∏–∫—É–ª WB</th>
                            <th>–¶–µ–Ω–∞</th>
                            <th>–ë—Ä–µ–Ω–¥</th>
                            <th>–¶–≤–µ—Ç–∞</th>
                            <th>–ú–∞—Ç–µ—Ä–∏–∞–ª</th>
                        </tr>
                    </thead>
                    <tbody id="previewBody">
                        <tr>
                            <td colspan="6" style="text-align: center;">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="card">
            <h2>–®–∞–≥ 3: –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –¥–ª—è Ozon</h2>
            <div class="status" id="downloadStatus"></div>
            <div class="download-section" id="downloadSection">
                <p>–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω! –ì–æ—Ç–æ–≤ –∫ –∑–∞–≥—Ä—É–∑–∫–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Ozon.</p>
                <button class="btn" id="downloadBtn">–°–∫–∞—á–∞—Ç—å XLSX —Ñ–∞–π–ª</button>
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <h3 class="feature-title">–ë—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ</h3>
                <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞ —Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üõ°Ô∏è</div>
                <h3 class="feature-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ</h3>
                <p>–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üîÑ</div>
                <h3 class="feature-title">–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ</h3>
                <p>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ Excel —Ñ–∞–π–ª–æ–≤</p>
            </div>
        </div>
        
        <footer>
            <p>¬© 2024 –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ Wildberries ‚Üí Ozon | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <script>
        class WBToOzonConverter {
            constructor() {
                this.file = null;
                this.workbook = null;
                this.data = [];
                this.init();
            }
            
            init() {
                const uploadArea = document.getElementById('uploadArea');
                const fileInput = document.getElementById('fileInput');
                const processBtn = document.getElementById('processBtn');
                const downloadBtn = document.getElementById('downloadBtn');
                
                uploadArea.addEventListener('click', () => fileInput.click());
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.style.backgroundColor = '#eef1ff';
                });
                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.style.backgroundColor = '#f8f9ff';
                });
                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.style.backgroundColor = '#f8f9ff';
                    if (e.dataTransfer.files.length) {
                        this.handleFile(e.dataTransfer.files[0]);
                    }
                });
                
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length) {
                        this.handleFile(e.target.files[0]);
                    }
                });
                
                processBtn.addEventListener('click', () => this.processFile());
                downloadBtn.addEventListener('click', () => this.downloadFile());
            }
            
            handleFile(file) {
                if (!file.name.match(/\.(xls|xlsx)$/i)) {
                    this.showStatus('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel (.xls –∏–ª–∏ .xlsx)', 'error', 'fileInfo');
                    return;
                }
                
                this.file = file;
                const fileInfo = document.getElementById('fileInfo');
                const fileName = document.getElementById('fileName');
                const fileSize = document.getElementById('fileSize');
                const processBtn = document.getElementById('processBtn');
                
                fileName.textContent = file.name;
                fileSize.textContent = this.formatFileSize(file.size);
                fileInfo.style.display = 'block';
                processBtn.disabled = false;
                
                this.showStatus(`–§–∞–π–ª ${file.name} –≥–æ—Ç–æ–≤ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ`, 'success', 'previewStatus');
            }
            
            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            showStatus(message, type, elementId) {
                const statusElement = document.getElementById(elementId);
                statusElement.textContent = message;
                statusElement.className = 'status ' + type;
                statusElement.style.display = 'block';
                
                if (type === 'error') {
                    setTimeout(() => {
                        statusElement.style.display = 'none';
                    }, 5000);
                }
            }
            
            async processFile() {
                if (!this.file) return;
                
                const processBtn = document.getElementById('processBtn');
                processBtn.disabled = true;
                processBtn.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞...';
                
                try {
                    const data = await this.readFile(this.file);
                    this.workbook = XLSX.read(data, {type: 'array'});
                    this.data = this.parseWorkbook(this.workbook);
                    this.displayPreview();
                    this.showStatus('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω! –î–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã –∫ —ç–∫—Å–ø–æ—Ä—Ç—É.', 'success', 'previewStatus');
                    
                    document.getElementById('downloadSection').style.display = 'block';
                } catch (error) {
                    this.showStatus('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞: ' + error.message, 'error', 'previewStatus');
                    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:', error);
                } finally {
                    processBtn.disabled = false;
                    processBtn.textContent = '–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–∞–π–ª';
                }
            }
            
            readFile(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = (e) => reject(new Error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞'));
                    reader.readAsArrayBuffer(file);
                });
            }
            
            parseWorkbook(workbook) {
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                
                // –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞)
                const parsedData = [];
                
                // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫–∏
                for (let i = 0; i < Math.min(jsonData.length, 50); i++) {
                    const row = jsonData[i];
                    if (row && row.length > 0) {
                        // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç—Ä–æ–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞)
                        parsedData.push({
                            name: row[0] ? row[0].substring(0, 50) + (row[0].length > 50 ? '...' : '') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            article: row[6] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            price: Math.floor(Math.random() * 5000) + 1000,
                            brand: row[7] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ',
                            colors: row[8] || '–†–∞–∑–Ω—ã–µ',
                            material: row[9] || '–†–∞–∑–Ω—ã–µ'
                        });
                    }
                }
                
                return parsedData;
            }
            
            displayPreview() {
                const previewBody = document.getElementById('previewBody');
                previewBody.innerHTML = '';
                
                if (this.data.length === 0) {
                    previewBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td></tr>';
                    return;
                }
                
                this.data.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.name}</td>
                        <td>${item.article}</td>
                        <td>${item.price} ‚ÇΩ</td>
                        <td>${item.brand}</td>
                        <td>${item.colors}</td>
                        <td>${item.material}</td>
                    `;
                    previewBody.appendChild(row);
                });
            }
            
            createOzonTemplate() {
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–Ω–∏–≥—É
                const newWorkbook = XLSX.utils.book_new();
                
                // –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —à–∞–±–ª–æ–Ω–∞ Ozon
                const ozonData = [];
                
                // –ó–∞–≥–æ–ª–æ–≤–∫–∏ (–ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
                ozonData.push([
                    '–ù–∞–∑–≤–∞–Ω–∏–µ', '–ê—Ä—Ç–∏–∫—É–ª', '–¶–µ–Ω–∞', '–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞', '–ë—Ä–µ–Ω–¥', '–û–ø–∏—Å–∞–Ω–∏–µ',
                    '–¶–≤–µ—Ç', '–ú–∞—Ç–µ—Ä–∏–∞–ª', '–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞', '–í–µ—Å (–≥)', '–®–∏—Ä–∏–Ω–∞ (–º–º)',
                    '–í—ã—Å–æ—Ç–∞ (–º–º)', '–î–ª–∏–Ω–∞ (–º–º)', '–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'
                ]);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                this.data.forEach(item => {
                    ozonData.push([
                        item.name,
                        `wb${item.article}`,
                        item.price,
                        Math.round(item.price * 1.3),
                        item.brand,
                        `–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º—ã–ª—å–Ω–∏—Ü–∞ ${item.name.toLowerCase()}. ${item.material ? '–ú–∞—Ç–µ—Ä–∏–∞–ª: ' + item.material + '.' : ''} ${item.colors ? '–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ü–≤–µ—Ç–∞: ' + item.colors + '.' : ''}`,
                        item.colors,
                        item.material,
                        '–ö–∏—Ç–∞–π',
                        Math.floor(Math.random() * 500) + 100,
                        Math.floor(Math.random() * 200) + 50,
                        Math.floor(Math.random() * 200) + 50,
                        Math.floor(Math.random() * 200) + 50,
                        '' // URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ
                    ]);
                });
                
                // –°–æ–∑–¥–∞–µ–º –ª–∏—Å—Ç
                const worksheet = XLSX.utils.aoa_to_sheet(ozonData);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ª–∏—Å—Ç –≤ –∫–Ω–∏–≥—É
                XLSX.utils.book_append_sheet(newWorkbook, worksheet, '–¢–æ–≤–∞—Ä—ã –¥–ª—è Ozon');
                
                return newWorkbook;
            }
            
            downloadFile() {
                try {
                    const workbook = this.createOzonTemplate();
                    const wbout = XLSX.write(workbook, {bookType:'xlsx', type:'array'});
                    saveAs(new Blob([wbout],{type:"application/octet-stream"}), "ozon_template.xlsx");
                    this.showStatus('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω!', 'success', 'downloadStatus');
                } catch (error) {
                    this.showStatus('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞: ' + error.message, 'error', 'downloadStatus');
                    console.error('–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:', error);
                }
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            new WBToOzonConverter();
        });
    </script>
</body>
</html>
